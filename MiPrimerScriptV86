//@version=3
study(title="Mi primer script", shorttitle="14_200", overlay=true)
// Input
//source = input(close)
Divisa =  input(1, minval=1, title="Divisa")
EMAcorta = input(14, minval=1, title="EMA Corta")
Volumen=input(50,minval=1, title="VWMA")
EMAlarga=input(200,minval=1, title="EMA Larga")
emaColor = input(true, title="EMA Tendencia")

// Calculo
src = input(close, title="Source")
ema14 = ema(src, EMAcorta)
vol = vwma(src, Volumen)
//ema200 = ema(src, EMAlarga)
ema1 =  ema(src, Divisa)
emaTend = ema(close, EMAlarga)

emaTendUp() => hlc3 >= emaTend
emaTendDown() => hlc3  < emaTend
col = hlc3  >= emaTend ? lime : hlc3  < emaTend ? red : white

//lineas
plot(ema14, color=red, linewidth=2, title="EMA_1", transp=0)
plot(vol, color=orange, linewidth=2, title="EMA", transp=0)
//plot(ema200, color=purple, linewidth=2, title="EMA200", transp=0)
plot(emaColor and emaTend ? emaTend : na, title="EMA_Larga", style=line, linewidth=3, color=col)
//barcolor(emaTendUp() ? lime: emaTendDown() ? red : na)

//indicador
plotshape(ema1 > ema14 and (ema14 > vol) and (vol > emaTend), style=shape.triangleup, location=location.top, color=green, size=size.small, title="Compra")
plotshape(emaTend > vol and (vol > ema14) and (ema14 > ema1), style=shape.triangledown, location=location.bottom, color=red, size=size.small, title="Venta")
plotshape(ema14 > ema1 and (ema14 > vol) and (vol > emaTend), style=shape.xcross, location=location.belowbar, color=red, size=size.small, title="Cerrar_Venta")
plotshape(emaTend > vol and (vol > ema14) and (ema1 > ema14), style=shape.xcross, location=location.belowbar, color=green, size=size.small, title="Cerrar_Compra")

//plotshape(ema1 > ema14 and (ema14 > vol) and (vol > ema200), style=shape.triangleup, location=location.top, color=green, size=size.small, title="Compra")
//plotshape(ema200 > vol and (vol > ema14) and (ema14 > ema1), style=shape.triangledown, location=location.bottom, color=red, size=size.small, title="Venta")
//plotshape(ema14 > ema1 and (ema14 > vol) and (vol > ema200), style=shape.xcross, location=location.belowbar, color=red, size=size.small, title="Cerrar_Venta")
//plotshape(ema200 > vol and (vol > ema14) and (ema1 > ema14), style=shape.xcross, location=location.belowbar, color=green, size=size.small, title="Cerrar_Compra")

//fondo
bgcolor(ema1 > emaTend and (ema14 > vol) and (vol > emaTend) ? green : na, transp=70)
bgcolor(emaTend > vol and (vol > ema14) and (ema14 > ema1) ? red : na, transp=70, title="Compra")
bgcolor(ema1 > ema14 and (ema14 > vol) and (vol > emaTend) ? green : na, transp=70)
bgcolor(emaTend > vol and (vol > ema14) and (ema14 > ema1) ? red : na, transp=70)

//bgcolor(ema1 > ema200 and (ema14 > vol) and (vol > ema200) ? green : na, transp=70)
//bgcolor(ema200 > vol and (vol > ema14) and (ema14 > ema1) ? red : na, transp=70, title="Compra")
//bgcolor(ema1 > ema14 and (ema14 > vol) and (vol > ema200) ? green : na, transp=70)
//bgcolor(ema200 > vol and (vol > ema14) and (ema14 > ema1) ? red : na, transp=70)