//Detrended Price Oscillator by HPotter
//https://es.tradingview.com/script/yMRm9CPq-Detrended-Price-Oscillator/
//@version=2

study(title="Detrended Price Oscillator", shorttitle="DPO")
Length = input(14, minval=1)
Series = input(title="Price", type=string, defval="close")
hline(0, color=gray, linestyle=line)
hline(68.1, color=orange, linestyle=line)
xPrice = close
xsma = sma(xPrice, Length)
nRes = xPrice - xsma
pos = iff(nRes > 0, 1,
	     iff(nRes < 0, -1, nz(pos[1], 0))) 
//barcolor(pos == -1 ? red: pos == 1 ? green : blue )
plot(nRes, color=black, title="Detrended Price Oscillator")
// Fondos
bgcolor(nRes < 68.1? na : green, transp=70)
